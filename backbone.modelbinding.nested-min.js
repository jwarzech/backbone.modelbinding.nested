/*
//  Backbone.ModelBinding.Nested 0.2.0
//  
//  (c) 2012 Jordan Warzecha
//  Distributed under the MIT license.
//
//  Documentation and full license available at:
//  http://github.com/jwarzech/backbone.modelbinding.nested
*/
var _this=this;Backbone.Model.prototype.setByName=function(b,c,a){var d;d={};d[b]=c;return this.set(d,a)};Backbone.Model.prototype.bindingId=function(){if(this.id!=null){return this.id}else{return this.cid}};Backbone.Collection.prototype.isCollection=function(){return true};Backbone.Collection.prototype.safeGet=function(a){if(this.get(a)!=null){return this.get(a)}else{return this.getByCid(a)}};Backbone.Model.prototype.buildCollection=function(a,b){if(this.has(a)&&this.get(a).length>0){this.setByName(a,new b(this.get(a)))}else{this.setByName(a,new b())}return this.get(a).parent=this};Backbone.Model.prototype.safeGet=function(a){return this.get(a)};Backbone.ModelBinding.parseNestedTokens=function(b,d){var c,e,a;e=d.shift();b=b.safeGet(e);c=d.shift();if(b.safeGet(c)&&(b.safeGet(c).isCollection!=null)){a=Backbone.ModelBinding.parseNestedTokens(b.safeGet(c),d);b=a.entity;c=a.attribute}return{entity:b,attribute:c}};Backbone.ModelBinding.nestedHandler={bind:function(a,b,c){return b.$(a).each(function(f,i){var h,e,g,d,j,k=this;j=i.id.split("-");if(j.length===1){e=c;h=_.first(j)}else{e=c.safeGet(j.shift());d=Backbone.ModelBinding.parseNestedTokens(e,j);e=d.entity;h=d.attribute}g=$(this).prop("tagName")==="INPUT"&&$(this).prop("type")==="checkbox";$(this).change(function(){if(g&&$(k).prop("checked")!==e.safeGet(h)){i=$(k).prop("checked")}else{if($(k).val()!==e.safeGet(h)){i=$(k).val()}}if(i!=null){return e.setByName(h,i)}});e.bind("change:"+h,function(){if(g&&e.safeGet(h)!==$(k).prop("checked")){return $(k).prop("checked",e.safeGet(h))}else{if(e.safeGet(h)!==$(k).val()){return $(k).val(e.safeGet(h))}}});if(g){return $(this).prop("checked",e.safeGet(h))}else{return $(this).val(e.safeGet(h))}})}};Backbone.ModelBinding.Conventions.text.handler=Backbone.ModelBinding.nestedHandler;Backbone.ModelBinding.Conventions.textarea.handler=Backbone.ModelBinding.nestedHandler;Backbone.ModelBinding.Conventions.password.handler=Backbone.ModelBinding.nestedHandler;Backbone.ModelBinding.Conventions.checkbox.handler=Backbone.ModelBinding.nestedHandler;Backbone.ModelBinding.Conventions.select.handler=Backbone.ModelBinding.nestedHandler;Backbone.ModelBinding.Conventions.radio.handler=Backbone.ModelBinding.nestedHandler;